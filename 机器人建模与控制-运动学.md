# 机器人建模与控制 · 运动学篇


> [!summary] 课程主线一眼看懂
> - **几何 → 运动学 → 动力学 → 轨迹规划 → 控制 → 行走案例**
> - 关键模型：
>   - 正/逆运动学、雅可比、操作能力  
>   - Lagrange & Newton–Euler 动力学  
>   - 关节/笛卡尔空间轨迹  
>   - PID + 前馈、计算力矩、力/阻抗控制与多足/双足行走  

---


## 0. 课程信息与整体结构

- 课程：**Robot Modeling & Control（ME331）**  
- 任课教师：**付成龙 Chenglong Fu**（SUSTech MEE）  
- 内容大致对应章节：  
  - 1–10：运动学（Kinematics I–IX）  
  - 11–15：动力学（Dynamics I–V）  
  - 16：轨迹规划 & 控制导论  
  - 17–19：执行器与控制（Control I–III）  

> [!tip] 学习顺序小建议  
> 1. 先把 **D-H 建模 + 正/逆运动学** 搞熟  
> 2. 再理解 **D(q)、C(q, q̇)、g(q)** 的来龙去脉  
> 3. 最后看 **控制律如何“利用”这些模型**（前馈补偿、计算力矩等）

---



## 1. 机器人与机械臂基础（Intro + Kin I–II）

### 1.1 机器人定义与 4D / 4A

- 机器人：可编程、多功能机械系统，用于完成搬运、装配、加工等任务  
- 典型环境：**4D**
  - Dangerous 危险  
  - Dirty 肮脏  
  - Dull 枯燥  
  - Difficult 困难  
- 目标任务：**4A**
  - Automation  
  - Augmentation  
  - Assistance  
  - Autonomous  

### 1.2 常见机械臂结构 & 指标

- 常见结构：PPP（直角坐标）、RRP（球坐标）、RRR（关节型）、SCARA、并联等  
- 关键指标：
  - 自由度 DOF  
  - 工作空间 Workspace  
  - 负载 Payload  
  - **精度 vs 重复定位精度**（考试常问）

---

## 2. 刚体运动学与姿态表示（Kin II–III）

### 2.1 旋转矩阵 & 齐次变换

- 坐标变换：  
  $$
  {}^A \mathbf{p} = {}^A R_B \ {}^B \mathbf{p}
  $$
- 齐次变换：  
  $$
  {}^A T_B =
  \begin{bmatrix}
  {}^A R_B & {}^A\mathbf{p}_B\\
  0\ 0\ 0 & 1
  \end{bmatrix}
  $$

- 逆变换：
  $$
  T^{-1} =
  \begin{bmatrix}
  R^T & -R^T p\\
  0 & 1
  \end{bmatrix}
  $$

### 2.2 Euler / Yaw–Pitch–Roll

- 常用姿态参数：**Yaw–Pitch–Roll (Z–Y–X)**：  
  $$
  R = R_z(\psi)R_y(\theta)R_x(\phi)
  $$
- 反求角度时用 `atan2` 保证象限正确  
- 注意 pitch=±90° 时的奇异（万向锁）现象

---

## 3. D-H 建模与正运动学（Kin III–V）

### 3.1 标准 D-H 四参数

对第 i 个关节：

- θᵢ：绕 zᵢ₋₁，从 xᵢ₋₁ → xᵢ  
- dᵢ：沿 zᵢ₋₁ 的平移  
- aᵢ：沿 xᵢ 的平移  
- αᵢ：绕 xᵢ，从 zᵢ₋₁ → zᵢ  

> [!note] 记忆口诀  
> - θ、d——“z 轴上的事情”，多与关节变量有关  
> - a、α——“x 轴上的几何”，多与连杆尺寸、夹角有关

### 3.2 相邻坐标系变换

$$
{}^{i-1}T_i(\theta_i, d_i, a_i, \alpha_i) =
\begin{bmatrix}
c\theta_i & -s\theta_i c\alpha_i & s\theta_i s\alpha_i & a_i c\theta_i \\
s\theta_i & c\theta_i c\alpha_i & -c\theta_i s\alpha_i & a_i s\theta_i \\
0 & s\alpha_i & c\alpha_i & d_i \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

### 3.3 正运动学 FK

- 链式相乘：  
  $$
  {}^0T_n(q) = {}^0T_1 {}^1T_2 \cdots {}^{n-1}T_n
  $$
- 得到末端位姿 $R^0_n, p^0_n$，其中：
  - 旋转矩阵表示姿态  
  - 平移向量表示末端位置  

---

## 4. 逆运动学 IK、雅可比与操作能力（Kin VI–IX）

### 4.1 几何 / 解耦逆运动学

- 球腕 6R 机械臂可“解耦”：
  1. 先用 wrist center 位置求前 3 个关节（手臂部分）  
  2. 再用末端姿态求后三个关节（腕部）  
- SCARA 等结构的 IK 常有 2 组解（肘上/肘下、肩左/肩右等）

### 4.2 雅可比矩阵 J(q)

- 定义：  
  $$
  \xi =
  \begin{bmatrix}
  v \\ \omega
  \end{bmatrix}
  = J(q)\,\dot{q}
  $$
- 对第 i 个关节（R 关节）：
  - 线速度部分：$J_{v,i} = z_{i-1} \times (o_n - o_{i-1})$  
  - 角速度部分：$J_{\omega,i} = z_{i-1}$  
- 对 P 关节：
  - 线速度部分：$J_{v,i} = z_{i-1}$  
  - 角速度部分：$J_{\omega,i} = 0$

> [!warning] 奇异性  
> - 当 rank(J) 降低（例如 det(J)=0）时，机器人处于奇异配置  
> - 某些方向末端速度无法产生，或需要无限大关节速度

### 4.3 操作能力 & 条件数（Manipulability）

- 给定奇异值 σ₁,…,σₘ，**可操作性指标**：
  $$
  \mu = \sigma_1 \sigma_2 \cdots \sigma_m = \sqrt{\det(JJ^T)}
  $$
- **条件数**：
  $$
  \kappa = \frac{\sigma_{\max}}{\sigma_{\min}} \quad(1 \le \kappa \le \infty)
  $$
  - κ 越大 → 越接近奇异，某些方向速度难以产生  

> [!tip] 2R 平面臂例子  
> - $\mu = l_1 l_2 \sin\theta_2$，当 $\theta_2 = 0,\pi$ 时 μ=0，为典型奇异姿态（两连杆共线）

### 4.4 数值逆运动学（Jacobian Inverse / Transpose）

- 目标：求解 f(q)=x 的 q_d，将  
  $$
  G(q) = x_d - f(q)
  $$
  看成零点问题。  
- **Jacobian 伪逆法**：
  $$
  q_{k} = q_{k-1} + \alpha_k J^+(q_{k-1})\,(x_d - f(q_{k-1}))
  $$
- **Jacobian Transpose 法**：利用  
  $\Delta q \propto J^T e$，近似梯度下降。
